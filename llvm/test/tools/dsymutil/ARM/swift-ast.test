RUN: llvm-dsymutil -oso-prepend-path %p/.. %p/../Inputs/swift-ast.macho.fat -o %T/swift-ast.dSYM -verbose -no-swiftmodule-timestamp | FileCheck %s --check-prefix=DSYMUTIL
RUN: llvm-readobj -sections -section-data %T/swift-ast.dSYM/Contents/Resources/DWARF/swift-ast.macho.fat | FileCheck %s --check-prefix=READOBJ

The tested object file has been created by the dummy Swift code:
let x = 1

Compiled with:
  swiftc /tmp/test.swift -Onone -target armv7-apple-ios8.1 -c -o swift-ast-armv7.o
  ld swift-ast-armv7.o -add_ast_path swift-ast.swiftmodule -arch armv7 -ios_version_min 8.1  -syslibroot /path/to/iPhoneOS.sdk -L/path/to/usr/lib/swift/iphoneos -lobjc -lSystem -o swift-ast.macho.armv7

  swiftc /tmp/test.swift -Onone -target arm64-apple-ios8.1 -c -o swift-ast-arm64.o
  ld swift-ast-arm64.o -add_ast_path swift-ast.swiftmodule -arch arm64 -ios_version_min 8.1  -syslibroot /path/to/iPhoneOS.sdk -L/path/to/usr/lib/swift/iphoneos -lobjc -lSystem -o swift-ast.macho.arm64

  lipo -create swift-ast.macho.armv7 swift-ast.macho.arm64 -o swift-ast.macho.fat

DSYMUTIL: filename:{{.*}}swift-ast.swiftmodule
DSYMUTIL: DEBUG MAP OBJECT:{{.*}}swift-ast.swiftmodule

READOBJ: Name:{{.*}}__swift_ast
READOBJ: |SWIFTMODULE DATA|
READOBJ-NEXT: |.|
READOBJ: |SWIFTMODULE DATA|
READOBJ-NEXT: |.|

RUN: llvm-dsymutil -oso-prepend-path %p/.. %p/../Inputs/swift-ast.macho.fat -no-output -verbose 2>&1 | FileCheck %s --check-prefix=TIMESTAMP
TIMESTAMP: Warning: Timestamp mismatch
