# Verify that lld can handle .lib files. "main.obj" refers _val1 and
# _val2 that are defined in "vars.lib".
#
# RUN: yaml2obj %p/Inputs/vars-main.obj.yaml > %t.obj
#
# RUN: lld -flavor link /out:%t1 /subsystem:console -- %t.obj \
# RUN:    %p/Inputs/vars.lib && llvm-objdump -d %t1 | FileCheck %s
#
# RUN: lld -flavor link /out:%t1 /subsystem:console /libpath:%p/Inputs \
# RUN:    -- %t.obj vars.lib && llvm-objdump -d %t1 | FileCheck %s
#
# RUN: lld -flavor link /out:%t1 /subsystem:console /libpath:%p/Inputs \
# RUN:    /defaultlib:vars.lib -- %t.obj && llvm-objdump -d %t1 | FileCheck %s
#
# RUN: LIB=%p/Inputs lld -flavor link /out:%t1 /subsystem:console \
# RUN:    -- %t.obj vars.lib && llvm-objdump -d %t1 | FileCheck %s
#
# RUN: LINK="/out:%t1 /subsystem:console -- %t.obj" lld -flavor link \
# RUN:    %p/Inputs/vars.lib && llvm-objdump -d %t1 | FileCheck %s

CHECK: Disassembly of section .text:
CHECK: .text:
CHECK:     1000:       55                    pushl   %ebp
CHECK:     1001:       8b ec                 movl    %esp, %ebp
CHECK:     1003:       ff 15 4c 20 40 00     calll   *4202572
CHECK:     1009:       8b 0d 50 20 40 00     movl    4202576, %ecx
CHECK:     100f:       03 01                 addl    (%ecx), %eax
CHECK:     1011:       5d                    popl    %ebp
CHECK:     1012:       c3                    ret
